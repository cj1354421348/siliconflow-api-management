# 构建和优化指南

本文档说明了如何构建和优化硅基流动API管理系统，以减小文件大小并提高性能。

## 构建过程

项目包含一个构建脚本，用于压缩和优化前端资源文件。构建过程包括以下步骤：

1. **CSS压缩**：使用clean-css将CSS文件压缩到最小尺寸
2. **JavaScript压缩**：使用Terser对JavaScript文件进行压缩和混淆
3. **文件复制**：将必要的文件复制到构建目录

## 使用构建脚本

### 1. 安装依赖

构建脚本需要额外的开发依赖：

```bash
npm install --save-dev terser clean-css-cli
```

这些依赖已经在package.json中配置，只需运行：

```bash
npm install
```

### 2. 运行构建

```bash
npm run build
```

构建完成后，所有优化后的文件将位于`build`目录中。

## 优化效果

构建过程通过以下方式减小文件大小：

1. **JavaScript压缩**：
   - admin.js: 从18.8KB减小到11.4KB (39%减少)
   - index.js: 从15.3KB减小到8.4KB (45%减少)

2. **CSS压缩**：
   - admin.css: 从5.2KB减小到4.1KB (21%减少)
   - index.css: 从5.6KB减小到4.5KB (20%减少)

## 生产环境部署

在生产环境中，服务器将自动使用构建目录中的压缩文件。要启用生产模式，请设置环境变量：

```bash
NODE_ENV=production
```

## 手动优化建议

除了自动构建过程，还可以通过以下方式进一步优化：

1. **图片优化**：
   - 使用适当的图片格式（WebP优于JPEG和PNG）
   - 压缩图片文件大小
   - 使用响应式图片

2. **代码分割**：
   - 将大型JavaScript文件拆分为更小的模块
   - 按需加载非关键功能

3. **缓存策略**：
   - 为静态资源设置适当的缓存头
   - 使用版本号或哈希值来管理缓存失效

4. **CDN使用**：
   - 对于常用的库文件，考虑使用CDN
   - 将静态资源分发到全球CDN节点

## 构建脚本说明

构建脚本(`scripts/build.js`)执行以下操作：

1. 创建构建目录结构
2. 复制HTML文件
3. 复制图像和其他静态资源
4. 压缩CSS文件
5. 压缩JavaScript文件
6. 复制库文件（已压缩）
7. 复制服务器文件
8. 复制配置和文档文件

## 注意事项

1. 构建过程不会修改源文件，所有优化都在构建目录中进行
2. 开发过程中仍然使用未压缩的源文件
3. 只有在生产环境中才使用压缩文件
4. 构建过程保留了所有功能，仅减小文件大小