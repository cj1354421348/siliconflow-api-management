<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title data-i18n="title">硅基流动API Key Management</title>
  <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
  <div class="header">
    <div class="logo">
      <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
      </svg>
    </div>
    <h1 data-i18n="title">硅基流动API Key Management</h1>
    <div class="subtitle" data-i18n="subtitle">API密钥管理系统</div>
    <button onclick="logoutAdmin()" class="btn btn-danger" style="position: absolute; top: 20px; right: 20px;" data-i18n="logoutButton">登出</button>
  </div>

  <div class="card">
    <h2 data-i18n="systemConfig">系统配置</h2>
    <div class="form-group">
      <label for="adminUsername" data-i18n="configFields.adminUsername">管理员用户名</label>
      <input type="text" id="adminUsername" class="form-control">
    </div>
    <div class="form-group">
      <label for="adminPassword" data-i18n="configFields.adminPassword">管理员密码</label>
      <input type="password" id="adminPassword" class="form-control">
    </div>
    <div class="form-group">
      <label for="authApiKey" data-i18n="configFields.authApiKey">验证API密钥 (用于验证用户访问本服务)</label>
      <input type="text" id="authApiKey" class="form-control">
    </div>
    <div class="form-group">
      <label for="pageSize" data-i18n="configFields.pageSize">每页显示数量</label>
      <input type="number" id="pageSize" class="form-control">
    </div>
    <div class="form-group">
      <label for="accessControl" data-i18n="configFields.accessControl">访问控制</label>
      <select id="accessControl" class="form-control">
        <option value="open" data-i18n="configFields.accessControlOptions.open">完全开放</option>
        <option value="restricted" data-i18n="configFields.accessControlOptions.restricted">部分开放</option>
        <option value="private" data-i18n="configFields.accessControlOptions.private">完全私有</option>
      </select>
    </div>
    <div class="form-group">
      <label for="guestPassword" data-i18n="configFields.guestPassword">访客密码</label>
      <input type="password" id="guestPassword" class="form-control">
    </div>
    <button onclick="saveConfig()" class="btn btn-primary" data-i18n="saveConfig">保存配置</button>
  </div>

  <div class="card">
    <h2 data-i18n="keyManagement">密钥管理</h2>
    <div class="form-group">
      <label for="newKey" data-i18n="addKey.label">新密钥</label>
      <div style="display: flex; gap: 10px;">
        <input type="text" id="newKey" class="form-control">
        <button onclick="addKey()" class="btn btn-primary" data-i18n="addKey.button">添加密钥</button>
      </div>
    </div>
    
    <div class="form-group">
      <label for="bulkKeys" data-i18n="bulkAdd.label">批量添加密钥</label>
      <textarea id="bulkKeys" class="bulk-add-area" placeholder="每行一个密钥，或用逗号分隔"></textarea>
      <div class="textarea-hint" data-i18n="bulkAdd.hint">支持每行一个密钥，或用逗号分隔多个密钥</div>
      <button onclick="addBulkKeys()" class="btn btn-primary" data-i18n="bulkAdd.button">批量添加</button>
    </div>
    
    <div class="refresh-controls">
      <button onclick="refreshAllBalances()" class="btn btn-primary" data-i18n="refreshControls.refreshAll">刷新所有余额</button>
      <button onclick="deleteInvalidKeys()" class="btn btn-warning" data-i18n="refreshControls.deleteInvalid">删除所有失效密钥</button>
      <div class="auto-refresh">
        <label for="autoRefresh" data-i18n="refreshControls.autoRefresh">自动刷新:</label>
        <select id="autoRefreshInterval" class="form-control" onchange="setAutoRefresh()">
          <option value="0" data-i18n="refreshControls.autoRefreshOptions.off">关闭</option>
          <option value="60000" data-i18n="refreshControls.autoRefreshOptions.1min">每分钟</option>
          <option value="300000" data-i18n="refreshControls.autoRefreshOptions.5min">每5分钟</option>
          <option value="900000" data-i18n="refreshControls.autoRefreshOptions.15min">每15分钟</option>
          <option value="1800000" data-i18n="refreshControls.autoRefreshOptions.30min">每30分钟</option>
          <option value="3600000" data-i18n="refreshControls.autoRefreshOptions.1hour">每小时</option>
        </select>
      </div>
    </div>

    <div id="stats" class="stats" style="display: none;">
      <div class="stat-item">
        <div class="stat-value total-keys" id="totalKeys">0</div>
        <div class="stat-label" data-i18n="stats.totalKeys">总API Keys</div>
      </div>
      <div class="stat-item">
        <div class="stat-value valid-keys" id="validKeys">0</div>
        <div class="stat-label" data-i18n="stats.validKeys">有效API Keys</div>
      </div>
      <div class="stat-item">
        <div class="stat-value total-balance" id="totalBalance">¥0.00</div>
        <div class="stat-label" data-i18n="stats.totalBalance">总额度</div>
      </div>
    </div>

    <div id="keyList" class="key-list"></div>
  </div>

  <div id="toast" class="toast"></div>

  <div class="language-switcher" style="position: fixed; top: 20px; right: 120px;">
    <select id="languageSwitcher">
      <option value="zh-CN">中文</option>
      <option value="en">English</option>
    </select>
  </div>

  <script src="/js/lib/i18next.min.js"></script>
  <script src="/js/lib/i18nextHttpBackend.min.js"></script>
  <script src="/js/admin-main.js" type="module"></script>
</body>
</html>